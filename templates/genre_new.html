{% extends "base.html" %}

{% block title %}新規ジャンル登録 - 図書管理システム{% endblock %}

{% block content %}
<div class="container">
    <h1>新しいジャンルを登録</h1>
    
    {% if parent_genre %}
        <div class="alert alert-info">
            <strong>親ジャンル:</strong> {{ parent_genre.name }} の下にサブジャンルを作成しています
        </div>
    {% endif %}
    
    {% if error %}
        <div class="alert alert-error">{{ error }}</div>
    {% endif %}

    <form method="post" class="genre-form">
        <div class="form-group">
            <label for="name">ジャンル名 *</label>
            <input type="text" id="name" name="name" value="{{ name or '' }}" required>
        </div>
        
        <div class="form-group">
            <label for="parent_id">親ジャンル</label>
            <select id="parent_id" name="parent_id">
                <option value="">なし（大分類として作成）</option>
                {% for genre in all_genres %}
                    {% if genre.level < 3 %}
                        <option value="{{ genre.id }}" 
                                {% if parent_genre and parent_genre.id == genre.id %}selected{% endif %}>
                            {% for i in range(genre.level - 1) %}　{% endfor %}{{ genre.name }}
                        </option>
                    {% endif %}
                {% endfor %}
            </select>
        </div>
        
        <div class="form-group">
            <label for="description">説明</label>
            <textarea id="description" name="description" rows="3">{{ description or '' }}</textarea>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-primary">登録</button>
            <a href="/genres" class="btn btn-secondary">キャンセル</a>
        </div>
    </form>
</div>
{% endblock %}